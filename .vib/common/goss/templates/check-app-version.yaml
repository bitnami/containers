# Copyright Broadcom, Inc. All Rights Reserved.
# SPDX-License-Identifier: APACHE-2.0

########################
# Checks asset version via its binary,
# independently of the output been shown through stdout or stderr
# Needed vars:
#   - .Vars.version.bin_name (String)
#   - .Vars.version.flag (String)
########################
command:
  check-app-version:
    exec:
    - {{ .Vars.version.bin_name }}
    - {{ .Vars.version.flag }}
    exit-status: 0
    # Allow matching in stdout
    stdout:
    - ".*{{ .Env.APP_VERSION }}.*"
    # Allow matching in stderr
    stderr:
    - ".*{{ .Env.APP_VERSION }}.*"
